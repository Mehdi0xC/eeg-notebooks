<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Cueing Behavioural Analysis Winter 2019 &#8212; eeg-notebooks 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          eeg-notebooks</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../about.html">About</a></li>
                <li><a href="../../user_guide/index.html">User guide</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="https://github.com/neurotechx/eeg-notebooks">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-analyze-data-cueing-behaviour-analysis-winter2019-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="cueing-behavioural-analysis-winter-2019">
<span id="sphx-glr-auto-examples-analyze-data-cueing-behaviour-analysis-winter2019-py"></span><h1>Cueing Behavioural Analysis Winter 2019<a class="headerlink" href="#cueing-behavioural-analysis-winter-2019" title="Permalink to this headline">¶</a></h1>
<p>The cueing task can ellicit a number of reliable changes. A central cue indicates the location of an upcoming target onset. Here the task can be changed to be perfectly predictive, or have some level of cue validity. Task is to indicate the orientation of a spatial grating on the target, up for vertical, right for horizontal.</p>
<p>ERP - Validly cued targets ellict larger ERP’s than invalidly cued targets</p>
<p>Response ERPs - Validly cued targets are more quickly identified and better identified</p>
<p>Oscillations - Alpha power lateralizes after a spatial cue onset preceeding the upcoming onset of a target. Alpha power becomes smaller contraleral to the target side, and larger ipsilateral with the target.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">eegnb.datasets</span> <span class="k">import</span> <span class="n">datasets</span>
</pre></div>
</div>
<p>Download the data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eegnb_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/&#39;</span><span class="p">),</span><span class="s1">&#39;.eegnb&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">cueing_data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">eegnb_data_path</span><span class="p">,</span> <span class="s1">&#39;visual-cueing&#39;</span><span class="p">,</span> <span class="s1">&#39;kylemathlab_dev&#39;</span><span class="p">)</span>

<span class="c1"># If dataset hasn&#39;t been downloaded yet, download it</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">cueing_data_path</span><span class="p">):</span>
      <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_dataset</span><span class="p">(</span><span class="n">data_dir</span><span class="o">=</span><span class="n">eegnb_data_path</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="s1">&#39;visual-cueing&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s1">&#39;kylemathlab_dev&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="analyze-mat-behavioural-data-for-accuracy-and-rt">
<h2>Analyze .mat behavioural data for Accuracy and RT<a class="headerlink" href="#analyze-mat-behavioural-data-for-accuracy-and-rt" title="Permalink to this headline">¶</a></h2>
<p>Load in subjects</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Fall 2018</span>
<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span>
        <span class="mi">202</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span>
        <span class="mi">301</span><span class="p">,</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">306</span><span class="p">,</span> <span class="mi">307</span><span class="p">,</span> <span class="mi">308</span><span class="p">,</span> <span class="mi">309</span><span class="p">]</span>

<span class="c1"># 105 - no trials in one condition</span>

<span class="c1"># # Winter 2019</span>
<span class="c1"># subs = [1101, 1102, 1103, 1104, 1105, 1106, 1108, 1109, 1110,</span>
<span class="c1">#         1202, 1203, 1205, 1206, 1209, 1210, 1211, 1215,</span>
<span class="c1">#         1301, 1302, 1313,</span>
<span class="c1">#         1401, 1402, 1403, 1404, 1405,  1408, 1410, 1411, 1412, 1413, 1413, 1414, 1415, 1416]</span>

<span class="c1"># # 1107 - no csv session 1</span>
<span class="c1"># # 1201 - no csv session 1</span>
<span class="c1"># # 1304 - Muse 2</span>
<span class="c1"># # 1308 - Muse 2</span>
<span class="c1"># # 1311 - Muse 2</span>
<span class="c1"># # 1314 - Muse 2</span>
<span class="c1"># # 1407 - only session1</span>

<span class="c1"># Both</span>

<span class="c1"># Fall 2018</span>
<span class="c1"># subs = [101, 102, 103, 104, 106, 108, 109, 110, 111, 112,</span>
<span class="c1">#         202, 203, 204, 205, 207, 208, 209, 210, 211,</span>
<span class="c1">#         301, 302, 303, 304, 305, 306, 307, 308, 309,</span>
<span class="c1">#         1101, 1102, 1103, 1104, 1105, 1106, 1108, 1109, 1110,</span>
<span class="c1">#         1202, 1203, 1205, 1206, 1209, 1210, 1211, 1215,</span>
<span class="c1">#         1301, 1302, 1313,</span>
<span class="c1">#         1401, 1402, 1403, 1404, 1405,  1408, 1410, 1411, 1412, 1413, 1413, 1414, 1415, 1416]</span>
</pre></div>
</div>
<p>Set some settings</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># basic numbers</span>
<span class="n">n_subs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">subs</span><span class="p">)</span>
<span class="n">n_sesh</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">,</span><span class="s1">&#39;invalid&#39;</span><span class="p">]</span>
<span class="n">n_cond</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>

<span class="c1"># cutoff trials that are too slow or fast</span>
<span class="n">rt_toofast</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">rt_tooslow</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="c1">#creates arrays to save output</span>
<span class="n">count_rt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_subs</span><span class="p">,</span> <span class="n">n_sesh</span><span class="p">,</span> <span class="n">n_cond</span><span class="p">))</span>
<span class="n">median_rt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_subs</span><span class="p">,</span> <span class="n">n_sesh</span><span class="p">,</span> <span class="n">n_cond</span><span class="p">))</span>
<span class="n">prop_accu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_subs</span><span class="p">,</span> <span class="n">n_sesh</span><span class="p">,</span> <span class="n">n_cond</span><span class="p">))</span>
</pre></div>
</div>
<p>Single Subject example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#select single subject</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">subs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Subject - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>

<span class="c1">#just one session</span>
<span class="n">sesh</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">#load file</span>
<span class="c1">#path =  &#39;./subject&#39; + str(sub) + &#39;/session&#39; + str(sesh) + &#39;/&#39;</span>
<span class="n">path</span> <span class="o">=</span>  <span class="n">cueing_data_path</span> <span class="o">+</span> <span class="s1">&#39;/subject&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/session&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sesh</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
<span class="n">file</span> <span class="o">=</span>  <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mat&#39;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">output_dict</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>

<span class="c1">#pull out important info</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">rt</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">validity</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span><span class="n">rt</span><span class="p">,</span><span class="n">validity</span><span class="p">)</span>

<span class="c1"># median rt on each condition</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rt</span><span class="p">[(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span>

<span class="n">validRT</span>     <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span> <span class="p">(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
                              <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span>
                              <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Valid RT = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">validRT</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; ms&#39;</span><span class="p">)</span>

<span class="n">InvalidRT</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span> <span class="p">(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span>
                              <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span>
                              <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid RT = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">InvalidRT</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; ms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Subject - 101
/home/john/.eegnb/data/visual-cueing/kylemathlab_dev/subject101/session1/subject101_session1_behOutput_2018-11-20-16.49.27.mat
[1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1.] [267.486316 368.197394 359.114961 443.325697 400.459867 338.903969
 335.497442 344.23244  356.226233 413.148977 379.451902 316.690498
 354.088677 373.602933 309.049937 434.614427 334.242317 347.36567
 559.56115  322.360502 342.381079 296.946102 363.025883 466.486784
 405.095436 319.433791 396.683878 383.602173 340.87966  354.004383
 376.375779 426.027515 354.717818 369.7502   422.330031 419.2258
 386.381543 359.174393 349.714812 356.469947 313.615834 322.796616
 441.424417 365.827293 374.314179 399.225807 419.822978 376.170782
 408.44391  410.311049 367.621084 317.141214 397.751161 356.786541
 358.868281 510.4043   482.490751 401.646274 389.68048  401.859856
 343.478114 402.49184  362.675449 414.434056 419.887543 529.755306
 370.726955 376.761684 392.066039 383.450714 339.717042 411.304441
 437.624038] [1. 0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 0. 1.
 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1. 1.
 1.]

[267.486316 368.197394 359.114961 443.325697 400.459867 338.903969
 335.497442 344.23244  356.226233 413.148977 379.451902 316.690498
 354.088677 373.602933 309.049937 434.614427 334.242317 347.36567
 559.56115  322.360502 342.381079 296.946102 363.025883 466.486784
 405.095436 319.433791 396.683878 383.602173 340.87966  354.004383
 376.375779 426.027515 354.717818 369.7502   422.330031 419.2258
 386.381543 359.174393 349.714812 356.469947 313.615834 322.796616
 441.424417 365.827293 374.314179 399.225807 419.822978 376.170782
 408.44391  410.311049 367.621084 317.141214 397.751161 356.786541
 358.868281 510.4043   482.490751 401.646274 389.68048  401.859856
 343.478114 402.49184  362.675449 414.434056 419.887543 529.755306
 370.726955 376.761684 392.066039 383.450714 339.717042 411.304441
 437.624038]
[368.197394 400.459867 434.614427 334.242317 322.360502 342.381079
 354.717818 419.2258   349.714812 419.822978 367.621084 343.478114
 362.675449 392.066039]
[368.197394 400.459867 434.614427 334.242317 322.360502 342.381079
 354.717818 419.2258   349.714812 419.822978 367.621084 343.478114
 362.675449 392.066039]
Valid RT = 376.37577899999997 ms
Invalid RT = 365.14826649988663 ms
</pre></div>
</div>
<p>Loop through subjects</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">isub</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Subject - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">sesh</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sesh</span><span class="p">):</span>
        <span class="c1"># get the path and file name and load data</span>
        <span class="c1">#path =  &#39;./subject&#39; + str(sub) + &#39;/session&#39; + str(sesh+1) + &#39;/&#39;</span>
        <span class="n">path</span> <span class="o">=</span>  <span class="n">cueing_data_path</span> <span class="o">+</span> <span class="s1">&#39;/subject&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/session&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sesh</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>

        <span class="n">file</span> <span class="o">=</span>  <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.mat&#39;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">output_dict</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>

        <span class="c1"># pull out important stuff</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">rt</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">validity</span> <span class="o">=</span> <span class="n">output</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># median rt on each condition</span>
        <span class="n">median_rt</span><span class="p">[</span><span class="n">isub</span><span class="p">,</span><span class="n">sesh</span><span class="p">,:]</span>      <span class="o">=</span> <span class="p">[</span>  <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span> <span class="p">(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span> <span class="p">(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span> <span class="p">]</span>

        <span class="c1"># proportion accurate (number accurate / count)</span>
        <span class="n">prop_accu</span><span class="p">[</span><span class="n">isub</span><span class="p">,</span><span class="n">sesh</span><span class="p">,:]</span>  <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">accuracy</span><span class="p">[(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span> <span class="o">/</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)),</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">accuracy</span><span class="p">[(</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">)])</span> <span class="o">/</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">validity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&gt;=</span> <span class="n">rt_toofast</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rt</span> <span class="o">&lt;=</span> <span class="n">rt_tooslow</span><span class="p">))</span> <span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Subject - 101
Subject - 102
Subject - 103
Subject - 104
Subject - 106
Subject - 108
Subject - 109
Subject - 110
Subject - 111
Subject - 112
Subject - 202
Subject - 203
Subject - 204
Subject - 205
Subject - 207
Subject - 208
Subject - 209
Subject - 210
Subject - 211
Subject - 301
Subject - 302
Subject - 303
Subject - 304
Subject - 305
Subject - 306
Subject - 307
Subject - 308
Subject - 309
</pre></div>
</div>
<p>Average over sessions and print data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary stats and collapse sessions</span>
<span class="n">Out_median_RT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">median_rt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Out_prop_accu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">prop_accu</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Median RT&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Out_median_RT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Proportion Accurate&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Out_prop_accu</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Median RT
[[361.7079635  364.45366275]
 [547.10713075 611.45526175]
 [600.073256   587.019756  ]
 [535.04144725 533.250092  ]
 [419.24263125 439.1580675 ]
 [456.3330375  631.1320265 ]
 [446.95026625 556.038382  ]
 [484.0763345  478.4887    ]
 [443.5412585  472.331497  ]
 [436.66653125 501.3115865 ]
 [495.63977675 587.358365  ]
 [520.97468575 973.144689  ]
 [395.5098235  370.232933  ]
 [489.59985525 560.08098575]
 [455.6651645  500.22833625]
 [662.9326765  643.0934405 ]
 [488.56224425 474.7125945 ]
 [482.1316255  543.0173155 ]
 [713.4103845  894.0804795 ]
 [485.48053725 533.6649235 ]
 [519.5475525  505.339771  ]
 [488.45884825 500.39610975]
 [527.5814465  533.4898155 ]
 [477.23867575 446.72875575]
 [484.94210575 578.6717025 ]
 [681.7458885  804.780758  ]
 [419.736862   485.569911  ]
 [435.42846425 437.12191   ]]
Proportion Accurate
[[0.98305085 0.96428571]
 [1.         1.        ]
 [0.91680961 0.88974359]
 [0.97767857 0.96428571]
 [0.9822995  1.        ]
 [0.95403439 0.6       ]
 [0.92346939 0.97727273]
 [0.99019608 0.97058824]
 [0.97395994 1.        ]
 [0.68275862 0.83333333]
 [0.89914021 0.89732143]
 [0.92080745 0.73333333]
 [0.94716042 0.91666667]
 [0.95755518 1.        ]
 [0.95959184 0.94949495]
 [0.88296296 0.94117647]
 [0.90046296 0.92857143]
 [0.96551724 0.875     ]
 [0.91171329 0.92857143]
 [0.98333333 0.9       ]
 [0.95535714 0.96153846]
 [0.94187987 0.95833333]
 [0.96479592 0.94736842]
 [1.         0.90833333]
 [0.94186047 0.8       ]
 [1.         1.        ]
 [0.97222222 0.97222222]
 [0.95718391 1.        ]]
</pre></div>
</div>
<p>Plot barplot of results</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># bar plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Accuracy</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">Out_prop_accu</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">Out_prop_accu</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_subs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span><span class="o">.</span><span class="mi">96</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion Correct&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
<span class="c1"># RT</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">Out_median_RT</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">Out_median_RT</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_subs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reaction Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RT (ms)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Condition&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_cueing_behaviour_analysis_winter2019_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_cueing_behaviour_analysis_winter2019_001.png" />
<p>Output spreadsheet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## CSV output</span>
<span class="n">column_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Participant&#39;</span><span class="p">:</span><span class="n">subs</span><span class="p">,</span>
               <span class="s1">&#39;AccValid&#39;</span><span class="p">:</span><span class="n">Out_prop_accu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
               <span class="s1">&#39;AccInvalid&#39;</span><span class="p">:</span><span class="n">Out_prop_accu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
               <span class="s1">&#39;RTValid&#39;</span><span class="p">:</span><span class="n">Out_median_RT</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
               <span class="s1">&#39;RTInvalid&#39;</span><span class="p">:</span><span class="n">Out_median_RT</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">column_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;375CueingBehPy.csv&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>    Participant  AccValid  AccInvalid     RTValid   RTInvalid
0           101  0.983051    0.964286  361.707963  364.453663
1           102  1.000000    1.000000  547.107131  611.455262
2           103  0.916810    0.889744  600.073256  587.019756
3           104  0.977679    0.964286  535.041447  533.250092
4           106  0.982299    1.000000  419.242631  439.158067
5           108  0.954034    0.600000  456.333038  631.132027
6           109  0.923469    0.977273  446.950266  556.038382
7           110  0.990196    0.970588  484.076334  478.488700
8           111  0.973960    1.000000  443.541259  472.331497
9           112  0.682759    0.833333  436.666531  501.311586
10          202  0.899140    0.897321  495.639777  587.358365
11          203  0.920807    0.733333  520.974686  973.144689
12          204  0.947160    0.916667  395.509823  370.232933
13          205  0.957555    1.000000  489.599855  560.080986
14          207  0.959592    0.949495  455.665165  500.228336
15          208  0.882963    0.941176  662.932677  643.093440
16          209  0.900463    0.928571  488.562244  474.712594
17          210  0.965517    0.875000  482.131626  543.017316
18          211  0.911713    0.928571  713.410385  894.080479
19          301  0.983333    0.900000  485.480537  533.664923
20          302  0.955357    0.961538  519.547552  505.339771
21          303  0.941880    0.958333  488.458848  500.396110
22          304  0.964796    0.947368  527.581447  533.489816
23          305  1.000000    0.908333  477.238676  446.728756
24          306  0.941860    0.800000  484.942106  578.671703
25          307  1.000000    1.000000  681.745889  804.780758
26          308  0.972222    0.972222  419.736862  485.569911
27          309  0.957184    1.000000  435.428464  437.121910
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  11.030 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-analyze-data-cueing-behaviour-analysis-winter2019-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/891c00ae93b3b0007e69e255f6e452ae/cueing_behaviour_analysis_winter2019.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">cueing_behaviour_analysis_winter2019.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9d4505d4d9307312002bdbffa0e03910/cueing_behaviour_analysis_winter2019.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">cueing_behaviour_analysis_winter2019.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020-2020, NeuroTechX.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>